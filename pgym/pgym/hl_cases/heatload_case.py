import os
import numpy as np
import pandas as pd


def hl_case():

    ## heat load case format: version 1.0
    hlc = {"version": "1"}

    ## system MVA base
    hlc["baseMVA"] = 1

    ## bus data
    # bus_i, type, Pd, Qd, Gs, Bs, area, Vm, Va, baseKV, zone, Vmax, Vmin
    hlc["bus"] = np.array([
        [1, 3, 0, 0, 0, 0, 1, 0.952287418, -2.50392167, 230, 1, 1.05, 0.95],
        [2, 1, 2, -0.8, 0, 0, 1, 1, 0, 230, 1, 1.05, 0.95],
        [3, 1, 0, 0, 0, 0, 1, 0.997890825, -1.10247216, 230, 1, 1.05, 0.95],
        [4, 1, 1, -0.5, 0, 0, 1, 1.19894254, 16.0131883, 230, 1, 1.05, 0.95],
        [5, 1, 0, 0, 0, 0, 1, 1.18694969, 14.7514859, 230, 1, 1.05, 0.95],
    ])

    ## branch data
    # fbus, tbus, r, x, b, rateA, rateB, rateC, ratio, angle, status, angmin, angmax, Pf, Qf, Pt, Qt
    hlc["branch"] = np.array([
        [2, 4, 0.0381, 0.0281, 0, 400, 400, 400, 0, 0, 1, -360, 360, -6.7379, 3.7114, 8.9924, -2.0486],
        [1, 2, 0.00304, 0.0304, 0, 0, 0, 0, 0, 0, 1, -360, 360, 1.5133, 1.4481, -1.5000, -1.3147],
        [2, 3, 0.00064, 0.0064, 0, 0, 0, 0, 0, 0, 1, -360, 360, 3.0058, 0.0578, -3.0000, -0.0000],
        [4, 5, 0.00108, 0.0108, 0, 0, 0, 0, 0, 0, 1, -360, 360, 3.0076, 1.0625, -3.0000, -0.9861],
    ])

    ## generator data
    # bus, Pg, Qg, Qmax, Qmin, Vg, mBase, status, Pmax, Pmin, Pc1, Pc2, Qc1min, Qc1max, Qc2min, Qc2max, ramp_agc, ramp_10, ramp_30, ramp_q, apf
    hlc["gen"] = np.array([
        [1, 0, 0, 3, -3, 1, 100, 1, 0.4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [3, 1, 0, 1, -1, 1, 100, 1, 1.7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [5, 2.5, 0, 1, -1, 1, 100, 1, 1.7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ])

    ## load data
    # bus_i, Pl, Pmax, Pmin, Tr, Ta, Tmax, Tmin, Rh, Ch, Th, Sh, Qh, Pout
    hlc["load"] = np.array([
        [1, 0, 2000, -2000, 297, 297, 273, 313, 0.946, 2.564e5, 3600, 60, 71, 0],
        [2, 0, 1000, -1000, 297, 297, 273, 313, 0.923, 2.201e5, 3600, 60, 61, 0],
        [4, 0, 1600, -1600, 297, 297, 273, 313, 0.917, 2.564e5, 3600, 60, 62, 0],
    ])

    # index of controlled load
    hlc["controlled_load"] = np.array([
        [0],
        [1],
        [2],
    ])

    # outdoor temperature before interpolation (unit: K)
    hlc["temperature"] = np.array([
        283.71, 283.15, 282.59, 282.04, 281.48, 282.04, 282.04, 281.48, 
        280.93, 281.48, 282.04, 283.15, 284.26, 284.82, 285.37, 285.37, 
        284.82, 283.15, 281.48, 282.59, 282.59, 280.93, 280.93, 279.82, 
        278.71, 278.71, 278.15, 277.59, 277.04, 278.71, 277.04, 278.15, 
        279.82, 280.93, 281.48, 283.15, 283.71, 284.82, 285.37, 284.82, 
        284.82, 285.37, 283.15, 282.59, 280.93, 280.93, 280.37, 279.82, 
        279.82, 278.15, 277.59, 277.59, 277.59, 277.59, 277.59, 279.26, 
        279.82, 282.04, 282.04, 282.04, 283.15, 283.15, 284.82, 284.82, 
        284.26, 283.15, 283.15, 282.59, 282.59, 282.04, 280.93, 280.37, 
        279.26, 279.26, 278.15, 278.71, 278.15, 278.71, 278.15, 278.15, 
        279.82, 282.04, 282.04, 282.59, 283.15, 283.71, 287.59, 290.37, 
        288.71, 287.04, 288.15, 283.15, 284.82, 284.26, 283.71, 283.15,
    ])
    
    # # outdoor temperature after interpolation (unit: K)
    # hlc["temperature"] = pd.DataFrame(pd.read_csv("./pgym/hl_cases/temperature_new.csv", header=None)).values.flatten()[0:96]

    # load curve before interpolation (unit: MW)
    hlc["load_curve"] = np.array([
        22362.14, 21443.99, 20802.71, 20415.67, 20363.70, 20780.50, 21513.30, 21516.47, 
        21355.87, 20731.49, 19959.38, 19616.49, 19364.46, 19564.31, 19899.76, 20621.09, 
        22321.42, 25909.74, 26952.74, 26739.07, 26209.08, 25313.07, 23999.79, 22494.99, 
        22496.32, 21892.76, 21502.01, 21509.31, 22220.16, 24072.41, 26977.52, 27968.05, 
        26972.42, 25772.44, 24548.87, 23631.16, 23114.05, 23053.19, 23292.05, 24139.07, 
        25867.21, 29210.73, 30003.35, 29641.90, 28956.05, 27578.43, 25678.53, 23822.13, 
        22322.15, 21573.53, 21189.81, 21167.11, 21840.19, 23599.38, 26033.96, 26960.23, 
        26439.49, 25425.34, 24336.04, 23403.92, 22882.98, 22794.49, 23007.39, 23596.45, 
        25016.20, 28208.53, 29096.51, 28726.24, 27982.24, 26706.00, 24909.21, 23192.75, 
        21957.29, 21187.83, 20838.69, 20816.06, 21432.87, 22947.27, 25472.00, 26209.64, 
        25388.68, 24481.18, 23584.28, 22737.71, 22246.52, 22342.57, 22622.31, 23478.82, 
        24897.45, 27658.50, 28140.52, 27700.86, 27092.74, 26156.03, 24579.44, 22879.55,
    ])
    
    # # load curve after interpolation (unit: MW)
    # hlc["load_curve"] = pd.DataFrame(pd.read_csv("./pgym/hl_cases/load_new.csv", header=None)).values.flatten()[0:96]

    return hlc

